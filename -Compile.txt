
setopt interactivecomments
# (sometimes) allows pasting into zsh without errors


# set up variables

imagename=ZCJukebox2.hdv
prodos_vol=ZCJKBX2
outpath=/Users/Frank/Desktop
image=$outpath/$imagename
prodos_path=/$prodos_vol

aud_pathNEW=/Volumes/TRANSFER/New\ ZC\ Audio\ Files/2\ -\ ZC\ Audio\ Files
#aud_pathALL=/Volumes/TRANSFER/New\ ZC\ Audio\ Files/_All\ 2018\ ZC\ Files

blank_img=/Volumes/TRANSFER/A2\ Disk\ Images/blank32mb.hdv.zip
blank_unp=blank.hdv

A2binpath=/Volumes/TRANSFER/A2_Binaries
V2config="/Users/Frank/Library/Application Support/Virtual ][/DefaultConfig.vii"


# delete old versions & set up new disk image
rm $image
unzip $blank_img -d $outpath
mv $outpath/$blank_unp $outpath/$imagename
cadius RENAMEVOLUME $image $prodos_vol


# add all audio files in folder
cd $aud_pathNEW
ls -1 *#D810* | sort | while read fn ; do cadius ADDFILE $image $prodos_path "$fn"; done
cd $aud_pathALL
ls -1 *#D810* | sort | while read fn ; do cadius ADDFILE $image $prodos_path "$fn"; done


# add QUIT.SYSTEM to drop to BitsyBye on boot
cadius ADDFILE $image $prodos_vol "$A2binpath/QUIT.SYSTEM#FF2000"


# compile audio player & add it
cd /Volumes/TRANSFER/play.zc.system/
acme play.zc.system.a
cadius ADDFILE $image $prodos_vol BASIS.SYSTEM#ff0000


# add PRODOS to make it bootable
cadius ADDFILE $image $prodos_vol "$A2binpath/PRODOS#FF0000"


#cadius CHECKVOLUME $image
#cadius CATALOG $image


# open new disk image in Virtual ][
osascript -e 'tell app "Virtual ][" to close every machine saving no'
osascript -e 'tell app "Virtual ][" to open "'"$V2config"'"'
osascript -e 'tell app "Virtual ][" to insert "'"$image"'" into device "S7D1" of front machine'
osascript -e 'tell app "Virtual ][" to type line "PR#7"'
osascript -e 'tell app "Virtual ][" to activate'


# close Terminal window
#exit

